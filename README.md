# CVE Mapper

CVE Mapper is a Python script that processes JSON files containing security violations and maps the threat severity level from Quay to Red Hat. The script can output the results to the console, a CSV file or create a Confluence page with the results table.

## Requirements

- Docker

## Getting Started

1. Clone the repository:

```sh
git clone https://github.com/jmelett/cve-mapper.git
cd cve-mapper
```

2. Build the Docker image:

```sh
docker build -t cve-mapper .
```

3. Run the script using Docker:

```sh
docker run -v /path/to/local/data:/data cve-mapper /data/input.json -o /data/output.csv
```

Replace `/path/to/local/data` with the actual path to the directory containing the input JSON files and where the output CSV files should be saved.

## Usage

```sh
usage: cve_mapper.py [-h] [-o OUTPUT] [-c CONFLUENCE] input

positional arguments:
input Path to JSON file or directory containing JSON files

optional arguments:
-h, --help show this help message and exit
-o, --output Path to CSV file to write results to
-c, --confluence Confluence credentials and space key: <base_url> <api_token> <space_key>
```

## Examples

1. Process a JSON file and print the results to the console:
```sh
python cve_mapper.py input.json
```

2. Process a JSON file and write the results to a CSV file:
```sh
python cve_mapper.py input.json -o output.csv
```
3. Process a directory containing JSON files and write the results to a CSV file:
```sh
python cve_mapper.py input_directory -o output.csv
```

4. Process a JSON file and create a Confluence page with the results table:

```sh
python cve_mapper.py input.json -c https://your_confluence_instance.com your_api_token your_space_key
```

5. Process a JSON file, write the results to a CSV file, and create a Confluence page with the results table:

```sh
python cve_mapper.py input.json -o output.csv -c https://your_confluence_instance.com your_api_token your_space_key
```

## Contributing

If you'd like to contribute to this project, please submit a pull request with your proposed changes.

## License

[MIT](LICENSE)